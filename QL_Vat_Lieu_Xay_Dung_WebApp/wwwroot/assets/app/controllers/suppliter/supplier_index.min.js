var SupplierAjax=function(){function i(){$("#frmMaintainance").validate({errorClass:"red",ignore:[],lang:"vi",rules:{txtName:{required:!0}}});$("#ddlShowPage").on("change",function(){app.configs.pageSize=$(this).val();app.configs.pageIndex=1;n(!0)});$("#btnSearch").click(function(t){t.preventDefault();n()});$("#txtKeyword").keypress(function(t){t.which===13&&(t.preventDefault(),n())});$("#btnCreate").on("click",function(){t();$("#modal-add-edit").modal("show")});$("body").on("click",".btn-edit",function(n){n.preventDefault();var t=$(this).data("id");$.ajax({type:"GET",url:"/Admin/Supplier/GetById",data:{id:t},dataType:"json",beforeSend:function(){app.startLoading()},success:function(n){var t=n;$("#hidId").val(t.Id);$("#txtName").val(t.FullName);$("#txtAddress").val(t.Address);$("#txtPhoneNumber").val(t.PhoneNumber);$("#ckStatus").prop("checked",t.Status===1);$("#hidDateCreated").val(t.DateCreated);$("#modal-add-edit").modal("show");app.stopLoading()},error:function(){app.notify("Có lỗi xảy ra","error");app.stopLoading()}})});$("body").on("click",".btn-delete",function(t){t.preventDefault();var i=$(this).data("id");app.confirm("Are you sure to delete?",function(){$.ajax({type:"POST",url:"/Admin/Supplier/Delete",data:{id:i},dataType:"json",beforeSend:function(){app.startLoading()},success:function(){app.notify("Xóa Thành Công","success");app.stopLoading();n(!0)},error:function(){app.notify("Có lỗi trong quá trình xóa","error");app.stopLoading()}})})});$("#btnSave").on("click",function(i){if($("#frmMaintainance").valid()){i.preventDefault();var r=$("#hidId").val(),u=$("#txtName").val(),f=$("#txtAddress").val(),e=$("#txtPhoneNumber").val(),o=$("#hidDateCreated").val(),s=$("#ckStatus").prop("checked")===!0?1:0;return $.ajax({type:"POST",url:"/Admin/Supplier/SaveEntity",data:{Id:r,FullName:u,Address:f,PhoneNumber:e,DateCreated:o,Status:s},dataType:"json",beforeSend:function(){app.startLoading()},success:function(){app.notify("Cập nhật supplier thành công","success");$("#modal-add-edit").modal("hide");t();app.stopLoading();n(!0)},error:function(){app.notify("Có lỗi trong quá trình lưu supplier","error");app.stopLoading()}}),!1}return!1})}function t(){$("#hidId").val(0);$("#txtName").val("");$("#txtAddress").val("");$("#txtPhoneNumber").val("");$("#ckStatus").prop("checked",!0);var n=new Date,t=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate();$("#hidDateCreated").val(t)}function n(t){var u=$("#table-template").html(),i="";$.ajax({type:"GET",data:{keyword:$("#txtKeyword").val(),page:app.configs.pageIndex,pageSize:app.configs.pageSize},url:"/Admin/Supplier/GetAllPaging",dataType:"json",success:function(f){$.each(f.ResultList,function(n,t){i+=Mustache.render(u,{Id:t.Id,Name:t.FullName,Address:t.Address,PhoneNumber:t.PhoneNumber,Status:app.getStatus(t.Status)})});$("#lblTotalRecords").text(f.RowCount);i!==""&&$("#tbl-content").html(i);r(f.RowCount,function(){n()},t)},error:function(n){console.log(n);app.notify("Không thể tải dữ liệu","error")}})}function r(n,t,i){var r=Math.ceil(n/app.configs.pageSize);($("#paginationUL a").length===0||i===!0)&&($("#paginationUL").empty(),$("#paginationUL").removeData("twbs-pagination"),$("#paginationUL").unbind("page"));$("#paginationUL").twbsPagination({totalPages:r,visiblePages:7,first:"Đầu",prev:"Trước",next:"Tiếp",last:"Cuối",onPageClick:function(n,i){app.configs.pageIndex=i;setTimeout(t(),200)}})}this.initialize=function(){n();i()}};