var SlideAjax=function(){function i(){$("#frmMaintainance").validate({errorClass:"red",ignore:[],lang:"vi",rules:{txtName:{required:!0},txtImage:{required:!0},txtUrl:{required:!0},txtGroupAlias:{required:!0}}});$("#ddlShowPage").on("change",function(){app.configs.pageSize=$(this).val();app.configs.pageIndex=1;n(!0)});$("#btnSearch").click(function(t){t.preventDefault();n()});$("#txtKeyword").keypress(function(t){t.which===13&&(t.preventDefault(),n())});$("#btnCreate").on("click",function(){t();$("#modal-add-edit").modal("show")});$("body").on("click",".btn-edit",function(n){n.preventDefault();var t=$(this).data("id");$.ajax({type:"GET",url:"/Admin/Slide/GetById",data:{id:t},dataType:"json",beforeSend:function(){app.startLoading()},success:function(n){var t=n;$("#hidId").val(t.Id);$("#txtName").val(t.Name);$("#txtImage").val(t.Image);$("#txtUrl").val(t.Url);$("#txtDisplayOrder").val(t.DisplayOrder);$("#txtGroupAlias").val(t.GroupAlias);$("#ckStatus").prop("checked",t.Status===1);$("#hidDateCreated").val(t.DateCreated);$("#modal-add-edit").modal("show");app.stopLoading()},error:function(){app.notify("Có lỗi xảy ra","error");app.stopLoading()}})});$("body").on("click",".btn-delete",function(t){t.preventDefault();var i=$(this).data("id");app.confirm("Are you sure to delete?",function(){$.ajax({type:"POST",url:"/Admin/Slide/Delete",data:{id:i},dataType:"json",beforeSend:function(){app.startLoading()},success:function(){app.notify("Xóa Thành Công","success");app.stopLoading();n(!0)},error:function(){app.notify("Có lỗi trong quá trình xóa","error");app.stopLoading()}})})});$("#btnSave").on("click",function(i){if($("#frmMaintainance").valid()){i.preventDefault();var r=$("#hidId").val(),u=$("#txtName").val(),f=$("#txtImage").val(),e=$("#txtUrl").val(),o=$("#txtDisplayOrder").val(),s=$("#hidDateCreated").val(),h=$("#txtGroupAlias").val(),c=$("#ckStatus").prop("checked")===!0?1:0;return $.ajax({type:"POST",url:"/Admin/Slide/SaveEntity",data:{Id:r,Name:u,Image:f,Url:e,DisplayOrder:o,GroupAlias:h,DateCreated:s,Status:c},dataType:"json",beforeSend:function(){app.startLoading()},success:function(){app.notify("Cập nhật slide thành công","success");$("#modal-add-edit").modal("hide");t();app.stopLoading();n(!0)},error:function(){app.notify("Có lỗi trong quá trình lưu slide","error");app.stopLoading()}}),!1}return!1});$("#btnSelectImg").on("click",function(){$("#fileInputImage").click()});$("#fileInputImage").on("change",function(){for(var r=$(this).get(0),t=r.files,i=new FormData,n=0;n<t.length;n++)i.append(t[n].name,t[n]);$.ajax({type:"POST",url:"/Admin/UploadImageFile/UploadImage",contentType:!1,processData:!1,data:i,success:function(n){$("#txtImage").val(n);app.notify("Tải ảnh lên thành công","success")},error:function(){app.notify("Có lỗi trong quá trình tải ảnh!","error")}})})}function t(){$("#hidId").val(0);$("#txtName").val("");$("#txtImage").val("");$("#txtUrl").val("");$("#txtDisplayOrder").val(0);$("#txtGroupAlias").val("");$("#ckStatus").prop("checked",!0);var n=new Date,t=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate();$("#hidDateCreated").val(t)}function n(t){var u=$("#table-template").html(),i="";$.ajax({type:"GET",data:{keyword:$("#txtKeyword").val(),page:app.configs.pageIndex,pageSize:app.configs.pageSize},url:"/Admin/Slide/GetAllPaging",dataType:"json",success:function(f){$.each(f.ResultList,function(n,t){i+=Mustache.render(u,{Id:t.Id,Name:t.Name,Image:t.Image===null?'<img src="img.jpg" width=25':'<img src="'+t.Image+'" width=25 />',Url:t.Url,DisplayOrder:t.DisplayOrder,GroupAlias:t.GroupAlias,Status:app.getStatus(t.Status)})});$("#lblTotalRecords").text(f.RowCount);i!==""&&$("#tbl-content").html(i);r(f.RowCount,function(){n()},t)},error:function(n){console.log(n);app.notify("Không thể tải dữ liệu","error")}})}function r(n,t,i){var r=Math.ceil(n/app.configs.pageSize);($("#paginationUL a").length===0||i===!0)&&($("#paginationUL").empty(),$("#paginationUL").removeData("twbs-pagination"),$("#paginationUL").unbind("page"));$("#paginationUL").twbsPagination({totalPages:r,visiblePages:7,first:"Đầu",prev:"Trước",next:"Tiếp",last:"Cuối",onPageClick:function(n,i){app.configs.pageIndex=i;setTimeout(t(),200)}})}this.initialize=function(){n();i()}};